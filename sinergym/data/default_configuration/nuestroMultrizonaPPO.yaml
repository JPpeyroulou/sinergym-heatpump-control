# Documentation: https://ugr-sail.github.io/sinergym/compilation/main/pages/environments_registration.html
# ---------------------------------------------------------------------------- #
#                        ID BASE FROM ENVIRONMNET NAMES                        #
# ---------------------------------------------------------------------------- #
id_base: nuestroMultizonaPPO

# ---------------------------------------------------------------------------- #
#                         BUILDING AND WEATHER SETTINGS                        #
# ---------------------------------------------------------------------------- #
building_file: idf_multiplesZonas_Bomba2.epJSON

# A environment alternative for each weather key
weather_specification:
  weather_files:
    - URY_Montevideo.epw
  keys:
    - uru

# ---------------------------------------------------------------------------- #
#                         BUILDING EXTRA CONFIGURATION                         #
# ---------------------------------------------------------------------------- #
building_config: null


# ---------------------------------------------------------------------------- #
#                        WEATHER VARIABILITY (OPTIONAL)                        #
# ---------------------------------------------------------------------------- #
# Alternative stochastic environments if it is defined
#weather_variability:
#  Dry Bulb Temperature:
#    - 1.0 # sigma
#    - 0.0 # mu
#    - 24.0 # tau

# ---------------------------------------------------------------------------- #
#                          EPISODES FOLDER GENERATION                          #
# ---------------------------------------------------------------------------- #
max_ep_store: 10

# ---------------------------------------------------------------------------- #
#                             OBSERVATION VARIABLES                            #
# ---------------------------------------------------------------------------- #

# --------------- TIME VARIABLES (same name as EnergyPlus API) --------------- #
time_variables:
  - month
  - day_of_month
  - hour
# More variables in Data Transfer API: https://energyplus.readthedocs.io/en/latest/datatransfer.html

# ----------------------------- OUTPUT:VARIABLES ----------------------------- #
variables:
  Zone Radiant HVAC Heating Rate:
    variable_names: heating_rate
    keys: 
      - LOZARADIANTE_ZONANORTH
      - LOZARADIANTE_ZONASOUTH
      - LOZARADIANTE_ZONAEAST
      - LOZARADIANTE_ZONAWEST
  
  # Variables ambientales (mantiene igual)
  Site Outdoor Air DryBulb Temperature:
    variable_names: outdoor_temperature
    keys: Environment
    
  Site Outdoor Air Relative Humidity:
    variable_names: outdoor_humidity
    keys: Environment
  
  # Variables de zona (cambia SPACE5-1 por NORTH PERIMETER)
  Zone Air Temperature:
    variable_names: air_temperature
    keys:
      - NORTH PERIMETER
      - SOUTH PERIMETER
      - EAST PERIMETER
      - WEST PERIMETER
    
  Zone Air Relative Humidity:
    variable_names: air_humidity
    keys:
      - NORTH PERIMETER
      - SOUTH PERIMETER
      - EAST PERIMETER
      - WEST PERIMETER

  # Variables de la bomba de calor (añadidas)
  Heat Pump Electricity Rate:
    variable_names: heat_pump_power
    keys: BOMBACALOR_HP


# ------------------------------- OUTPUT:METERS ------------------------------ #
meters:
#  Electricity:HVAC: total_electricity_HVAC
  Heat Pump:Heating:Electricity: total_electricity_HVAC

# ---------------------------------------------------------------------------- #
#                               ACTION VARIABLES                               #
# ---------------------------------------------------------------------------- #

# --------------------------- ACTUATORS TO CONTROL --------------------------- #
actuators:
  # Para controlar el setpoint de calefacción radiante (Setpoint_Constante_22)
  ZonaNorth:
    variable_name: electrovalve_north
    element_type: Schedule:Compact
    value_type: Schedule Value
  ZonaSouth:
    variable_name: electrovalve_south
    element_type: Schedule:Compact
    value_type: Schedule Value
  ZonaEast:
    variable_name: electrovalve_east
    element_type: Schedule:Compact
    value_type: Schedule Value
  ZonaWest:
    variable_name: electrovalve_west
    element_type: Schedule:Compact
    value_type: Schedule Value
  
  # Para controlar el setpoint de la bomba de calor (Temperatura_Calefaccion_Schedule)
  Temperatura_Calefaccion_Schedule:
    variable_name: bomba
    element_type: Schedule:Compact
    value_type: Schedule Value

# ---------------------------------------------------------------------------- #
#                   DYNAMIC CONTEXT CONFIGURABLE IN REAL-TIME                  #
# ---------------------------------------------------------------------------- #
context: {}

# ---------------------------------------------------------------------------- #
#                                 ACTIONS SPACE                                #
# ---------------------------------------------------------------------------- #
action_space: gym.spaces.Box(
  low=np.array([0, 0, 0, 0, 15], dtype=np.float32), 
  high=np.array([0, 0, 1, 1, 45], dtype=np.float32), 
  shape=(5,), 
  dtype=np.float32
  )


only_discrete: false
#action_space_discrete: gym.spaces.Discrete(10)

# ---------------------------------------------------------------------------- #
#                                REWARD FUNCTION                               #
# ---------------------------------------------------------------------------- #
reward: sinergym.utils.rewards:NuestroRewardMultizona
#reward: sinergym.utils.rewards:LinearReward

reward_kwargs:
  temperature_variables:
    #- north_perimeter_air_temperature
    #- south_perimeter_air_temperature
    - east_perimeter_air_temperature
    - west_perimeter_air_temperature
  humidity_variables:
    #- north_perimeter_air_humidity
    #- south_perimeter_air_humidity
    - east_perimeter_air_humidity
    - west_perimeter_air_humidity
  energy_variables:
    - heat_pump_power
  #range_comfort_winter:
  #  - 20.0
  #  - 23.5
  #range_comfort_summer:
  #  - 23.0
  #  - 26.0
  #summer_start:
  #  - 11
  #  - 1
  #summer_final:
  #  - 3
  #  - 30
  energy_weight: 0.5
  lambda_energy: 1.0
  lambda_temperature: 25.0
  tarifa_json: /workspaces/sinergym/sinergym/data/tarifas/tarifas_ute.json

  # ---------------------------------------------------------------------------- #
#                                WRAPPERS CONFIG                               #
# ---------------------------------------------------------------------------- #
wrappers:
  - DatetimeWrapper
  - NormalizeObservation
  - ForecastWrapper:
      forecast_csv: /workspaces/sinergym/sinergym/data/weather/forecast/forecast_24h.csv
      horizon: 24
  - EnergyCostWrapper
